+ Формирование фейковой игры на основе нормальной и стоп момента.
+ Рефакторинг кода. Еще раз посмотреть логичность.
+ Прокрутка 5 рук и просмотр фейковый ситуаций. Это где-то 60-70 ситуаций.
+ Их модификация и смотреть как меняется. Смотри файл fake_preflop_explain. 5 рук
+ Подсчет уникальности. Максимум 500 000

Флоп(август):
+ Формирование структуры флопа на основании структуры префлопа
+ Генерация карт флопа.
+ Тесты
    + Нет паники 100 постфлопов на основе префлопов
    + Нельзя создать неуникальные карты флопа
    + Всегда уникальные карты флопа 100 круток
    + Всегда уникальные карты префло + флоп 100 круток
    + Перетикание пота
!- Логика продолжения или конца после префлопа, когда пять игроков сфолдило.(Для фековой ситуации пофиг, ибо нет точки решения, opencv не надо работать, я победил)
+ Логика реальной игры на флопе
    + Как сделать полиморфизм мать его идить. Если не получится, то сделать FlopGame = PostflopGame
    + Проверить еще раз логику кода
+ 50 рук проверить. Проверел 10, но за счет префлоп симуляции лимпов это ок.
+ Расчет реальной комбинации
    + Стриты неправильные!
    + Тесты: сравнение рук внутри одной комбинации
    + Тесты: сравнение разных комбинаций
    + Debug ReadyHand
    + Вывод комбинации и проверка 5 раздач, это 60 готовых рук
+ Фейковая ситуация
+ Фейковый борд
+ Подумать spr считать от текущего пота ибо на втором кругу торгов в точке решения пофигу на ситуацию после пре. И в целом то что уже случилось не важно для текущей ситуации.
+ Еще раз проверка логики, особенно рейз-пота
+ Тест 10 рук. Все супер! и экшен и фейк
+ Фейковая комбинация на основе реальной комбинации
    + Тесты если борд из трех(флоп)
    + Тесты если борд с трипсом из трех(это всегда младший фулл)
    + Тест если борд с каре
    + Тесты есть стрит структуры борда с бордами на флопе(A&!A), терне с А и без(AQ952, AQ962, AQ322), со спаркой и без(AQQ72 нет стрита)
    + фейковый стрит натс или не натс!
    + Тесты на фейковый натс и не натс стрит с А и нет. 
        +Street(T), T98-, T87-, T76+, KQT76-, T9877-, TT776+
        +Street(A) AKQ98+, AJT8+, 
        +Street(5) AKQ54-, A9843+
    + Тесты на сеты и трипсы
    + Тест на трипс с флопа(это Nothing), каре с терна (это имба)
    + Тесты на две топ пары (+AAK92 tp-A-K, AAKK9 !tp-A-Q, AAQQ9 tp-A-K, KKQ92 tp-A-K, AK992 tp-A-K,    55443 tp-A-5, 322 tp-A-3)
    + Тесты на две топ-боттом пары и все остальное боттом-боттом
    + Тесты на топпару/оверпару на обычном и спаренном борде
    + Фейковые флешдро
    + Тесты на фейковые флеш-дро, в основном флоп или терн
    + TDD на стрейт-дро
    + Добавить тест oesd на спаренном борде(1+), возможно врап на спаренном тоже(1+)
    + Натс и мидл флеш неправильно, нужно смотреть то же самое в флешдро
    + Тесты дополнить тесты на флеш, натс ненатс, трифлеш, четырефлеш, пятьфлешдоски
    + Подумать о том, чтобы добавить бэкдор. Добавил вариант 2 БД, т.к. это +10% ЕВ на флопе
    + Тесты на BDFD(есть одно на флопе, есть два на флопе, нет на флопе, никогда нет на терне)
+ Фейковая флоп пауза
+ Прокрутка 5 рук и просмотр фейковый ситуаций. Это где-то 65 ситуаций.
+ Подсчет количества уникальности каждой из оставляющей фековой флоп паузы и сравнение с расчетным кол-вом
+ Подсчет уникальности. Максимум 500 000
+ Оптимизировать флоп, потомучто фейк борд и фейк хэнд можно считать сильно меньшее количество раз.
    Каждый раз нужно считать только фейковую ситуацию
+ Посчитать реальные частоты. 
    Флоп на 1M раздач:
        Только ситуации 98 (Hash map len 84, max 30862, min 58) !Никаких расхождений
        Только борд 18 (Hash map len 11, max 347337, min 16534) !Видимо спарка не совместима со
            стритовостью на флопе 
        Только оценка руки 300 (Hash map len 164, max 1170628, min 1) !Тоже несовместимость
            некоторых вещей, например трипс с флопа и сд/фд
+ Посчитать скорости работы 1М раздач, чтобы узнать что дольше всего:
    + Только ситуация + борд: 26 (50)
    + Полная ситуация: 
        Только реальная комбинация: 61 (111)
        Реальная комбинация + фейк реальной составляющей: 0 (111)
        Реальная комбинация + фейк флешовой составляющей: 4 (115)
        Реальная комбинация + фейк стритовой составляющей: 46 (157)
        Все: 160-161 -> 116
+ Наибольшая длительность у расчета комбинации и это офигеть как плохо, т.к. на ривере х60 по времени.
    хоть чуть-чуть ускорю за счет выноса рангов, сортировки, мепы.
    Если бы можно наиболее частые комбы искать первыми, то это сильно ускорит все (например
    начать с пары, потом две пары, а потом уже все остальное)
+ Оптимизировать фейковую комбинацию. Возможно только при выводи на верхний уровень всего, что
    связано с бекдором.
+ Все таки добавлю в структуру борда 4 вида: А**, AB*, BB*, ***
!?- И если так, то может расширить структуру флопа и добавить ГШ, 1БД, чтобы сделать все супер точно,
    кроме потери информации об агрессоре на префлопе.

!!! При расчете выигрыша обязательно проверить случай Пот 40, оп1 30аи, я 200 и по экшену я могу сделать рейз, хотя в реальности только колл.
!!! Подумать и может добавить выбор действий из 5-и а не 3-х
!!! Проверить чтоб сайзинги 50,75,100 бились с фек ситуациями иначе херня

                        ТЕРН
+ Тесты:
    + Проверка дедкарт и чтобы не было дублей на 100 генераций префлоп-флоп-терн
    + Проверка дедкарт на их количество на терне
    + Проверка уникальности карт борда на флопе и терне
    + Проверка уникальности карт терн + карманные карты (общее количество разных 28)
    + Просмотреть/добавить тесты готовой руки терна
    + Найти тесты сравнения реальных фуллов, если нет, то добавить
        Js 9s 2s 2h
        (30bb)(Utg)Jd 9c 9h 6c Full: +<3>9<2>2 ([F, C(9), R(29)]) [pot.b. 18] [m.bet 6] -> F
        (94bb)(Co)Kd Jc 7s 2c Full: +<3>2<2>J ([F, C(9), R(23)]) [pot.b. 18] [m.bet 6] -> C(9)
+ Унификация создания следующей улицы на основе предыдущей
+ Код. Проверка рассчета возможных действий
+ Код. Проверка end_of_street()
+ Код. do_action_on_position
+ Код. Проверка рассчета готовой руки
+ Посчитать количество флопов и сравнить, если на префлопе все лимпы, синтетика префлоп, чтобы
    разобраться с вариативностью флопа. Предполагаю, что отличаться будет в 3-5 раз и это нормально.
+ Рефакторинг main.rs
+ Проверка 5 рук при синтетике префлопа и флопа
    +++++ Реальная комбинация
    +++++ Проверка рассчета возможных действий
    ++++ Размеры пота
    + Размеры стеков
    + Проверка неповторяемости карт

                        РИВЕР
+ Унификация создания следующей улицы на основе предыдущей
+ Быстро. Код. Проверка from turn
+ Быстро. Код. Проверка рассчета возможных действий
+ Быстро. Код. Проверка end_of_street()
+ Быстро. Код. do_action_on_position
+ Быстро. Код. Проверка рассчета готовой руки
+ Проверка 5 рук при синтетике префлопа и флопа
    + +++++Реальная комбинация
    + +++++Проверка рассчета возможных действий
    + +++Размеры пота
    + ++Проверка неповторяемости карт
    + +Размеры стеков (без синтетики)
+ Расчет реального выигрыша.(сентябрь 13-17)
+ Учитывать рейк при результате

                        ФЕЙКИ
+ Фейк терна(сентябрь 3-9)
    + Проверить логичность FakeBoard для терна и ривера.
        + Если слишком много вариантов здесь можно убрать варианты FakeSuitBoard для терна убрав 4ss = 3ss!
        для ривера нельзя превращать в есть флеш или нет, ибо вскрытие блефов бастеддро!
        !- Если слишком много вариантов здесь можно убрать варианты FakeStreetBoard для ривера и даже терна есть/нет!
        !- Если слишком много вариантов здесь можно убрать варианты FakeBoardStruct для ривера и даже терна есть/нет туз и все, потому что это не важная характеристика, когда карт много!
    + Проверить логичность FakePostflopHand для терна и ривера.
        + ready
        + flash_draw
            + Для ривера вообще убрать
        + street_draw
            + Для ривера вообще убрать
    + Проверить логичность FakeSituation для терна и ривера.
+ Фейк ривера(октябрь 10-15)
+ Реальный результат на всех улицах
+ Реальный результат с учетом рейка
+ Проверить 50 рук по логике раздачи и по фейкам и по результатам. Из них 10 должны закончиться на ривере.
    + Префлоп одной симуляцией все проверил (GOOD_TEST_PRE) там и правильное определение OR, 3bet, 4bet 
    и правильное определение позиции агрессора(сложный кейс) и разная глубина и все шансы банка!
    + Флоп проверил
    + Терн
    + Ривер
+ Еще раз подумать о фейке ривера
+ Дописать результат для всех фейк пауз раздачи
+ redis изучить
    + Запись префлопа в redis
    + Написать get_postflop_key()
    + Проверить вывод отдельно для флопа, терна, ривера как проверял префлоп на логику
    + Мега важный баг-фикс постфлопа, когда все чекнули
    + Свернуть get_postflop_key() через Display видимо
    + заполнить redis_record для postflop
    + Префлоп 850к(key+id) на 1млн раздач, посчитать сколько флоп-терн-ривер. Ривера очень мало,
        поэтому хорошо бы чтобы не было больше 10к, т.е. в 100 раз меньше
        flop = 178k
        turn = 180k
        river 16k
+ Придумать как проверить redis_record на результат и руки
+ Течет память У процесса через 20-30 минут 2.5 Гб. Однако когда заполнял отдельно ривер, то 2.5 Гб было через 5 часов.
+ Расчет 0 поколения.
+ Проверить терн, ривер. 
+ Запустить расчет корректировочный 0 поколения. С учетом двух поправок на бакеты.
+ Выбор действия из прошлого поколения. Два игрока рандомные и они есть нейросеть.
+ Проверить генерацию пота, стеков, игроков в фолде
+ Проверить правильно ли выиграл или нет
+ Изменить выигрыш, когда все фолд
+ Написание проверочного GUI (апрель)
- Расчет 10 поколений ривера, свертка итогов, работа с запросами на чтение(май)
    - Напишу 10 очевидных тестов префлоп на каждую позицию опен
    - Напишу 10 очевидных тестов префлоп на каждую позицию проти 3-бет
    - Напишу 10 очевидных тестов префлоп на каждую позицию проти 4-бет
- Курсы питона, книга для чайников(май)
- Чтение про opencv(июнь)
- Чтение питон для чайников(опционально июль)
- Написание opencv для одного стола(август, сентябрь, октябрь)
- Написание opencv для 4-х столов и подружить питон и раст (ноябрь, декабрь)

======================Минусы стратегии для дальнейшей версии===========================
1. На ривере должно быть мало фейков, я их сильно уменьшил для борда и для фейк руки
Хорошо бы добавить если нет спарки но есть три флешовые карты - поиск натсового блокера
Хорошо бы добавить если нет спарки и нет трех флешовые карты, но возможен стрит - поиск количества блокеров на стрит
2. Отсутствует история экшена. Кто был агрессором на предыдущих улицах
Хорошо бы добавить хотя бы выбор это был я или не я 
*С этим связана большая проблема. Так как борды сортируются, то на ривере все равно когда закрылся флеш.*
*Возможное решение, кроме я или не я агрессор придется добавить изменился или не изменился ли натс на улице.*
*Эту проблему буду решать, если текущая нейронка побьет пло25*
3. На префлопе добавить новый показатель - шансы банка. Мне кажется, что очень не хватает.

+!!! Посмотри sample_side_pots1.txt. Там смазывается фейковая ситуация тем, что если я не делал действия на
префлопе со свободной позиции, то у меня может стоять неоправдвнно большой лузрейт. Есть идея заменить
самый близкий и неточный параметр RatioNeedCoomitToPot(разброс всего 54 и 55 %) на вариант, когда там будет указано
вкладывал ли я деньги в пот или нет(строго больше чем 1ББ). Будет опять же неточный параметр замазан ли я или нет, но все же спасет от неоправданных лузрейтов со свободной позиции.

+!!! Мне разонравился спр на постфлопе. Думаю нужно поменять на иеньше 1, 1-4, 4-

======================Адаптация в процессе============================================
1. Уже на #1 появляются на ривере ч-р с сетом на нестритовом не флешовом борде.
2. #3 демонстрирует лютую нитовость на стувку(вплоть до фолда ненатсового стрита и кола абсолютного натс стрита) и лютую агрессию при действии первым
    просто наэниту ставит в толпу. Лютая агрессия кстати объяснима при таких нито-коллерах
3. Ожидаю от #4 менее лютой агрессии и не нитовтой а тайтовости при колвх.
=====================Перед расчетом поколения нейросети================================
1. Убедиться что оба дебаг мода в ЛОЖЬ и  вывод в redis::best_asction()
2. Запустить с потоком вывода в консоль и проверить что ничего не печатается
3. Сделать 11 потоков
4. Сделать 2_300_000 рук в каждои потоке
5. Запустить редиску, очистить редиску.
6. Загрузить в редиску 2-а прошлого поколение и 0-е поколение
7. Проверить что раскоменниторава запись в редиску
8. cargo run > redis.txt --release -- -g 5 -c 4
   ml_brain.exe > redis.txt -g 0 -c 1
====================Доски, которые я играю сам==========================================
Потомучто в фейках идет микс сильных и слабых рук:
-Доски с трипсом имея фулхауз
-Доски со структурой ААК имея А


-------------------------------------------
100_000 in 1 thread. Goal 15 sec
1. All fakes, all real = 199 sec
2. - fake board struct = 159 sec (takes 40 sec). 
        from inline = 
3. - fake situation = 

100_000 only river w/o fakes 19 sec
+ fakeboard inline 20 sec
+ real comb inline 101 sec (with regular calc it takes 114) (deep fake into all cycles 28)
all with release 25

+ Более продуманная генерация терна
+ Посмотреть и вспомнить все от и до по работе с редиской
+ Переделать запись в редуску програмно а не через судо, оставив сохранение в файл*Ы*
+ Запуск поколений в цикле
- Релизный бинарник запускать два раза в сутки на 8 часов. В сутки будет 10 поколений. В это время прорабатываю терн.

rivergame <(fake1,pos1,comb1),(fake2,pos2,comb2)> && HashSet of fakes

1. Для каждого фейка из сета
	100 раз
	2. Ищу все k-v, в которых есть этот фейк и выбираю рандомный rivergame 
	3. Играю
	* При этом веду подстчет игр для каждого фейка и если они уже есть после предыдущей итерации по сету, то играю не 100 раз, а меньше
	** В такой логике нужно отсотрировать сет от наиболее редких к наиболее частым. Для этого нужно смотреть на составляющую my_fake_hand.ready.
	(Imba, LowFullHouse, NutFlash, SecondThreeFlash, ..., BottomBottom, TPOP, Nothing) Скорее всего для последних 3 из 15 вообще не будет отдельных игр

После нового года подумать над возвращением фейка борда в 6, иначе 1000 поколений для ривера ок, для терна или флопа это не ок, т.к. 5 дней